-- MySQL Script generated by MySQL Workbench
-- Mon Nov 14 14:44:06 2016
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering
-- <%= p("cc.srv_api_uri") %>
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema usb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema usb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `usb` DEFAULT CHARACTER SET utf8 ;
USE `usb` ;

-- -----------------------------------------------------
-- Table `usb`.`Config`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `usb`.`Config` ;

CREATE TABLE IF NOT EXISTS `usb`.`Config` (
	  `KEY` VARCHAR(255) NOT NULL,
	  `VALUE` VARCHAR(1000) NULL,
	  `COMPONENT` VARCHAR(255) NULL COMMENT '    ')
	ENGINE = InnoDB;


	-- -----------------------------------------------------
-- Table `usb`.`Instances`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `usb`.`Instances` ;

CREATE TABLE IF NOT EXISTS `usb`.`Instances` (
	  `Guid` VARCHAR(32) NOT NULL,
	  `Name` VARCHAR(45) NULL,
	  `TargetURL` TEXT NULL,
	  `AuthKey` VARCHAR(45) NULL,
	  `CaCert` BLOB NULL,
	  `SkipSSL` TINYINT(1) NULL,
	  PRIMARY KEY (`Guid`))
	ENGINE = InnoDB;


	-- -----------------------------------------------------
-- Table `usb`.`Plans`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `usb`.`Plans` ;

CREATE TABLE IF NOT EXISTS `usb`.`Plans` (
	  `Guid` VARCHAR(36) NOT NULL,
	  `Name` TEXT(255) NULL,
	  `Description` TEXT(255) NULL,
	  `Free` TINYINT(1) NULL COMMENT '    ',
	  `Metadata` BLOB NULL,
	  PRIMARY KEY (`Guid`))
	ENGINE = InnoDB;


	-- -----------------------------------------------------
-- Table `usb`.`Dials`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `usb`.`Dials` ;

CREATE TABLE IF NOT EXISTS `usb`.`Dials` (
	  `Guid` VARCHAR(36) NOT NULL,
	  `Configuration` BLOB NULL,
	  `Plans_Guid` VARCHAR(36) NOT NULL,
	  `Instances_Guid` VARCHAR(32) NOT NULL,
	  PRIMARY KEY (`Guid`),
	  INDEX `fk_Dials_Plans1_idx` (`Plans_Guid` ASC),
	  INDEX `fk_Dials_Instances1_idx` (`Instances_Guid` ASC),
	  CONSTRAINT `fk_Dials_Plans1`
	    FOREIGN KEY (`Plans_Guid`)
	    REFERENCES `usb`.`Plans` (`Guid`)
	    ON DELETE NO ACTION
	    ON UPDATE NO ACTION,
	  CONSTRAINT `fk_Dials_Instances1`
	    FOREIGN KEY (`Instances_Guid`)
	    REFERENCES `usb`.`Instances` (`Guid`)
	    ON DELETE NO ACTION
	    ON UPDATE NO ACTION)
	ENGINE = InnoDB;


	-- -----------------------------------------------------
-- Table `usb`.`Services`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `usb`.`Services` ;

CREATE TABLE IF NOT EXISTS `usb`.`Services` (
	  `Guid` VARCHAR(36) NOT NULL,
	  `Bindable` TINYINT(1) NULL,
	  `DashboardClient` BLOB NULL,
	  `Description` TEXT(255) NULL,
	  `Metadata` BLOB NULL,
	  `Name` TEXT(255) NULL,
	  `PlanUpdateable` TINYINT(1) NULL,
	  `Tags` BLOB NULL,
	  `Instances_Guid` VARCHAR(32) NOT NULL,
	  `Requires` BLOB NULL,
	  PRIMARY KEY (`Guid`),
	  INDEX `fk_Services_Instances1_idx` (`Instances_Guid` ASC),
	  CONSTRAINT `fk_Services_Instances1`
	    FOREIGN KEY (`Instances_Guid`)
	    REFERENCES `usb`.`Instances` (`Guid`)
	    ON DELETE NO ACTION
	    ON UPDATE NO ACTION)
	ENGINE = InnoDB;


	SET SQL_MODE=@OLD_SQL_MODE;
	SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
	SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
